<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>mesa_geo.geoagent &#8212; Mesa-Geo 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Vibur" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyterlite_sphinx.css?v=ca70e7f1" />
    <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/jupyterlite_sphinx.js?v=d6bdf5f8"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />





  </head><body>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">


          <div class="body" role="main">

  <h1>Source code for mesa_geo.geoagent</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">GeoAgent and AgentCreator classes</span>
<span class="sd">---------------------------------</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyproj</span>
<span class="kn">from</span> <span class="nn">mesa</span> <span class="kn">import</span> <span class="n">Agent</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">mapping</span>
<span class="kn">from</span> <span class="nn">shapely.geometry.base</span> <span class="kn">import</span> <span class="n">BaseGeometry</span>
<span class="kn">from</span> <span class="nn">shapely.ops</span> <span class="kn">import</span> <span class="n">transform</span>

<span class="kn">from</span> <span class="nn">mesa_geo.geo_base</span> <span class="kn">import</span> <span class="n">GeoBase</span>


<div class="viewcode-block" id="GeoAgent">
<a class="viewcode-back" href="../../apis/geoagent.html#mesa_geo.geoagent.GeoAgent">[docs]</a>
<span class="k">class</span> <span class="nc">GeoAgent</span><span class="p">(</span><span class="n">Agent</span><span class="p">,</span> <span class="n">GeoBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for a geo model agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">geometry</span><span class="p">,</span> <span class="n">crs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new agent.</span>

<span class="sd">        :param unique_id: Unique ID for the agent.</span>
<span class="sd">        :param model: The model the agent is in.</span>
<span class="sd">        :param geometry: A Shapely object representing the geometry of the agent.</span>
<span class="sd">        :param crs: The coordinate reference system of the geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Agent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
        <span class="n">GeoBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">geometry</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">total_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">bounds</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="GeoAgent.to_crs">
<a class="viewcode-back" href="../../apis/geoagent.html#mesa_geo.geoagent.GeoAgent.to_crs">[docs]</a>
    <span class="k">def</span> <span class="nf">to_crs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoAgent</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_to_crs_check</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span>

        <span class="n">agent</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">agent</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">is_exact_same</span><span class="p">(</span><span class="n">crs</span><span class="p">):</span>
            <span class="n">transformer</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span>
                <span class="n">crs_from</span><span class="o">=</span><span class="n">agent</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">crs_to</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span> <span class="n">always_xy</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="n">agent</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_transformed_geometry</span><span class="p">(</span><span class="n">transformer</span><span class="p">)</span>
            <span class="n">agent</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">agent</span></div>


<div class="viewcode-block" id="GeoAgent.get_transformed_geometry">
<a class="viewcode-back" href="../../apis/geoagent.html#mesa_geo.geoagent.GeoAgent.get_transformed_geometry">[docs]</a>
    <span class="k">def</span> <span class="nf">get_transformed_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformer</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the transformed geometry given a transformer.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">transform</span><span class="p">(</span><span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoAgent.step">
<a class="viewcode-back" href="../../apis/geoagent.html#mesa_geo.geoagent.GeoAgent.step">[docs]</a>
    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Advance one step.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>


    <span class="k">def</span> <span class="nf">__geo_interface__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a GeoJSON Feature. Removes geometry from attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">properties</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="n">properties</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
        <span class="n">geometry</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
        <span class="n">geometry</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">geometry</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">mapping</span><span class="p">(</span><span class="n">geometry</span><span class="p">),</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="n">properties</span><span class="p">,</span>
        <span class="p">}</span></div>



<div class="viewcode-block" id="AgentCreator">
<a class="viewcode-back" href="../../apis/geoagent.html#mesa_geo.geoagent.AgentCreator">[docs]</a>
<span class="k">class</span> <span class="nc">AgentCreator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create GeoAgents from files, GeoDataFrames, GeoJSON or Shapely objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent_class</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">agent_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Define the agent_class and required agent_kwargs.</span>

<span class="sd">        :param agent_class: The class of the agent to create.</span>
<span class="sd">        :param model: The model to create the agent in.</span>
<span class="sd">        :param crs: The coordinate reference system of the agent. Default to None,</span>
<span class="sd">            and the crs from the file/GeoDataFrame/GeoJSON will be used.</span>
<span class="sd">            Otherwise, geometries are converted into this crs automatically.</span>
<span class="sd">        :param agent_kwargs: Keyword arguments to pass to the agent_class.</span>
<span class="sd">            Must NOT include unique_id.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">agent_kwargs</span> <span class="ow">and</span> <span class="s2">&quot;unique_id&quot;</span> <span class="ow">in</span> <span class="n">agent_kwargs</span><span class="p">:</span>
            <span class="n">agent_kwargs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;unique_id&quot;</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Unique_id should not be in the agent_kwargs&quot;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">agent_class</span> <span class="o">=</span> <span class="n">agent_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent_kwargs</span> <span class="o">=</span> <span class="n">agent_kwargs</span> <span class="k">if</span> <span class="n">agent_kwargs</span> <span class="k">else</span> <span class="p">{}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">crs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the coordinate reference system of the GeoAgents.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crs</span>

    <span class="nd">@crs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">crs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the coordinate reference system of the GeoAgents.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_crs</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">CRS</span><span class="o">.</span><span class="n">from_user_input</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span> <span class="k">if</span> <span class="n">crs</span> <span class="k">else</span> <span class="kc">None</span>

<div class="viewcode-block" id="AgentCreator.create_agent">
<a class="viewcode-back" href="../../apis/geoagent.html#mesa_geo.geoagent.AgentCreator.create_agent">[docs]</a>
    <span class="k">def</span> <span class="nf">create_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geometry</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a single agent from a geometry and a unique_id. Shape must be a valid Shapely object.</span>

<span class="sd">        :param geometry: The geometry of the agent.</span>
<span class="sd">        :param unique_id: The unique_id of the agent.</span>
<span class="sd">        :return: The created agent.</span>
<span class="sd">        :rtype: self.agent_class</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">BaseGeometry</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Geometry must be a Shapely Geometry&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unable to set CRS for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">agent_class</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> due to empty CRS in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">new_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_class</span><span class="p">(</span>
            <span class="n">unique_id</span><span class="o">=</span><span class="n">unique_id</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
            <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">agent_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">new_agent</span></div>


<div class="viewcode-block" id="AgentCreator.from_GeoDataFrame">
<a class="viewcode-back" href="../../apis/geoagent.html#mesa_geo.geoagent.AgentCreator.from_GeoDataFrame">[docs]</a>
    <span class="k">def</span> <span class="nf">from_GeoDataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdf</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">set_attributes</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a list of agents from a GeoDataFrame.</span>

<span class="sd">        :param gdf: The GeoDataFrame to create agents from.</span>
<span class="sd">        :param unique_id: The column name of the data to use as the agents unique_id.</span>
<span class="sd">            If &quot;index&quot;, the index of the GeoDataFrame is used. Default to &quot;index&quot;.</span>
<span class="sd">        :param set_attributes: Set agent attributes from GeoDataFrame columns.</span>
<span class="sd">            Default True.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">unique_id</span> <span class="o">!=</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
            <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">unique_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span><span class="p">:</span>
                <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gdf</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unable to set CRS for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">agent_class</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> due to empty CRS in both &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">gdf</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

        <span class="n">agents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">geometry</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="n">new_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_agent</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">set_attributes</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">new_agent</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
            <span class="n">agents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_agent</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">agents</span></div>


<div class="viewcode-block" id="AgentCreator.from_file">
<a class="viewcode-back" href="../../apis/geoagent.html#mesa_geo.geoagent.AgentCreator.from_file">[docs]</a>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">set_attributes</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create agents from vector data files (e.g. Shapefiles).</span>

<span class="sd">        :param filename: The vector data file to create agents from.</span>
<span class="sd">        :param unique_id: The column name of the data to use as the agents unique_id.</span>
<span class="sd">            If &quot;index&quot;, the index of the GeoDataFrame is used. Default to &quot;index&quot;.</span>
<span class="sd">        :param set_attributes: Set agent attributes from GeoDataFrame columns. Default True.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">agents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_GeoDataFrame</span><span class="p">(</span>
            <span class="n">gdf</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="n">unique_id</span><span class="p">,</span> <span class="n">set_attributes</span><span class="o">=</span><span class="n">set_attributes</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">agents</span></div>


<div class="viewcode-block" id="AgentCreator.from_GeoJSON">
<a class="viewcode-back" href="../../apis/geoagent.html#mesa_geo.geoagent.AgentCreator.from_GeoJSON">[docs]</a>
    <span class="k">def</span> <span class="nf">from_GeoJSON</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">GeoJSON</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
        <span class="n">unique_id</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span>
        <span class="n">set_attributes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create agents from a GeoJSON object or string. CRS is set to epsg:4326.</span>

<span class="sd">        :param GeoJSON: The GeoJSON object or string to create agents from.</span>
<span class="sd">        :param unique_id: The column name of the data to use as the agents unique_id.</span>
<span class="sd">            If &quot;index&quot;, the index of the GeoDataFrame is used. Default to &quot;index&quot;.</span>
<span class="sd">        :param set_attributes: Set agent attributes from GeoDataFrame columns. Default True.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">gj</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">GeoJSON</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">GeoJSON</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">GeoJSON</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">gj</span><span class="p">)</span>
        <span class="c1"># epsg:4326 is the CRS for all GeoJSON: https://datatracker.ietf.org/doc/html/rfc7946#section-4</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="s2">&quot;epsg:4326&quot;</span>
        <span class="n">agents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_GeoDataFrame</span><span class="p">(</span>
            <span class="n">gdf</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="n">unique_id</span><span class="p">,</span> <span class="n">set_attributes</span><span class="o">=</span><span class="n">set_attributes</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">agents</span></div>
</div>

</pre></div>

          </div>

        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Mesa-Geo</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/overview.html">Introductory Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/overview.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apis/api_main.html">API Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2017-2024, Project Mesa-Geo Team.

      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>

    </div>




  </body>
</html>